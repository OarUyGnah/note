

I/O 多路复用是一种使得程序能同时监听多个文件描述符的技术，从而提高程序的性能。I/O 多路复用能够在**单个线程中**，通过监视多个 I/O 流的状态来同时管理多个 I/O 流，一旦检测到某个文件描述符上我们关心的事件发生（就绪），能够通知程序进行相应的处理（读写操作）。



#### 优点：

- 比基于进程的设计给程序员更多对程序行为的控制
- 基于IO多路复用的事件驱动服务器是运行在单一进程上下文中，每个逻辑流都能访问该进程的全部地址空间

#### 缺点：

- 编码复杂，随着并发粒度减小，复杂性还会上升





select、poll和epoll都是Linux下的I/O多路复用机制，用于处理多个文件描述符的事件。

1. select：
select是最古老的I/O多路复用机制。它使用一个fd_set集合来存储文件描述符，并通过select函数来监视这些文件描述符的状态变化。select函数会阻塞，直到有文件描述符准备就绪或超时。select的缺点是每次调用时需要将fd_set集合从用户态拷贝到内核态，这个开销随着文件描述符数量的增加而线性增加。

2. poll：
poll是select的改进版本。它使用一个pollfd数组来存储文件描述符，并通过poll函数来监视这些文件描述符的状态变化。poll函数会阻塞，直到有文件描述符准备就绪或超时。poll的优势在于不需要每次调用时拷贝fd_set集合，而是直接传递一个指向pollfd数组的指针，减少了开销。但是poll仍然需要遍历整个pollfd数组来找到就绪的文件描述符，当文件描述符数量较大时，性能仍然不高。

3. epoll：
epoll是Linux特有的I/O多路复用机制，是select和poll的改进版本。epoll使用一个epoll_event数组来存储文件描述符，并通过epoll_create、epoll_ctl和epoll_wait等函数来监视和处理文件描述符的事件。epoll_wait函数会阻塞，直到有文件描述符准备就绪或超时。epoll的优势在于它采用了事件驱动的方式，只有活跃的文件描述符才会被处理，而不需要遍历整个数组。此外，epoll还支持边缘触发和水平触发两种模式，边缘触发模式只在状态变化时通知一次，水平触发模式则会一直通知直到状态变化。

总结：
- select和poll适用于文件描述符数量较小的情况，开销较大。
- epoll适用于文件描述符数量较大的情况，性能较好。
- epoll支持事件驱动、边缘触发和水平触发等特性，更加灵活和高效。