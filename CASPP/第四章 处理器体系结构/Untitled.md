本章自定义一个Y86-64指令集

## Y86-64指令集体系结构

### 程序员可见的状态

每条指令都会读取或修改处理器状态的某些部分

设置15个寄存器

![image-20221014093134941](../image/image-20221014093134941.png)

Y86-64用虚拟地址引用内存位置

### Y86-64指令

指令集基本是x86-64的子集

只有8字节数据(字word)

![image-20221014094614084](../image/image-20221014094614084.png)

### 指令编码

![image-20221014094746325](../image/image-20221014094746325.png)

15个寄存器对应范围0-0xE之间的寄存器标识符

![image-20221014095038650](../image/image-20221014095038650.png)



例如用16进制表示指令`rmmovq %rsp,0x123456789abcd(%rdx)`字节编码

```asm
rmmovq	%rsp 	%rdx	小端 0x123456789abcd先填充为 0x000123456789abcd
40 		4		2 		cdab896745230100
```

30F30F00000000000000

#### RISC和CISC指令集

x86-64有时候称为CISC：复杂指令集计算机

RISC：精简指令集计算机

![image-20221014123157277](../image/image-20221014123157277.png)

### Y86-64异常

![image-20221014123414132](../image/image-20221014123414132.png)

### Y86-64程序

![image-20221014125526380](../image/image-20221014125526380.png)

![image-20221014132314552](../image/image-20221014132314552.png)